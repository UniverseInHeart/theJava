[TOC]



## RPC基本原理

RPC是远程过程调用（Remote Procedure Call）的缩写形式。

分布式底层都是RPC

像调用本地方法一样调用远程方法

RPC的简化版原理，核心是代理机制。 

1. 本地代理存根: Stub （AOP或动态代理）

2. 本地序列化反序列化 

3. 网络通信 （TCP/SSL 简单， HTTP/HTTPS 效率高）

4. 远程序列化反序列化 

5. 远程服务存根: Skeleton （例如 dubbo 默认将接口和实现类配置到Spring）

6. 调用实际业务服务 

7. 原路返回服务结果 

8. 返回给本地调用方

<img src="/Users/xjf/IdeaProjects/theJava/分布式服务/pic/image-20201213151018779.png" alt="image-20201213151018779" style="zoom:50%;" />





## RPC技术框架

### Hessian

### Thrift

### Protocol Buffer

### gRPC





## 如何设计RPC

> 基于共享接口还是IDL? 
>
> 动态代理 or AOP？ 
>
> 序列化用什么？文本 or 二进制？ 
>
> 基于TCP还是HTTP?
>
> 服务端如何查找实现类？
>
> 异常处理







## 从RPC到分布式服务化



1. 多个相同服务如何管理？ 
2. 服务的注册发现机制？ 
3. 如何负载均衡，路由等集群功能？ 
4. 熔断，限流等治理能力。 
5. 重试等策略 
6. 高可用、监控、性能等等

<img src="/Users/xjf/IdeaProjects/theJava/分布式服务/pic/image-20201213223354023.png" alt="image-20201213223354023" style="zoom:70%;" />



### 作业：













-------------------------------------------















